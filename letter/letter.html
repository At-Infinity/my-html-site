<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Romantic Mailbox</title>
<link href="https://fonts.googleapis.com/css2?family=Parisienne&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
<style>
    :root{
        --bg1:#ffeef2;
        --bg2:#fff7fb;
        --rose:#ff6b9f;
        --petal:#ffd6e3;
        --mail:#ffd9ef;
        --accent:#ff3d7f;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
        margin:0;
        font-family:Montserrat, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        background: radial-gradient(circle at 10% 20%, rgba(255,235,245,0.9), transparent 20%),
                                radial-gradient(circle at 90% 80%, rgba(255,245,240,0.9), transparent 20%),
                                linear-gradient(180deg,var(--bg1),var(--bg2));
        display:flex;
        align-items:center;
        justify-content:center;
        overflow:hidden;
        color:#3a1a2d;
    }

    /* floating hearts and flowers */
    .sky{
        position:fixed;
        inset:0;
        pointer-events:none;
    }
    .flower{
        position:absolute;
        width:120px;
        height:120px;
        opacity:.9;
        transform-origin:center;
        animation:float 8s ease-in-out infinite;
    }
    .flower.s1{left:6%; top:12%; transform:scale(.9); animation-duration:10s}
    .flower.s2{right:6%; bottom:6%; transform:scale(.8); animation-duration:12s}
    .flower.s3{left:20%; bottom:22%; transform:scale(.6); animation-duration:14s}
    @keyframes float{
        0%{transform:translateY(0) rotate(0deg)}
        50%{transform:translateY(-18px) rotate(6deg)}
        100%{transform:translateY(0) rotate(0deg)}
    }

    /* teddy bears decorative */
    .teddy{
        position:absolute;
        width:84px;
        height:84px;
        opacity:.95;
        pointer-events:none;
        transform-origin:center;
        animation:float 10s ease-in-out infinite;
        filter:drop-shadow(0 6px 12px rgba(120,40,80,0.08));
    }
    .teddy.t1{left:8%; bottom:10%; transform:scale(.85); animation-duration:11s}
    .teddy.t2{right:10%; top:8%; transform:scale(.9); animation-duration:13s}

    /* main card */
    .stage{
        position:relative;
        width:360px;
        max-width:90vw;
        padding:28px;
        border-radius:20px;
        background:linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,250,252,0.9));
        box-shadow: 0 8px 30px rgba(120,40,80,0.15), inset 0 1px 0 rgba(255,255,255,0.6);
        text-align:center;
        user-select:none;
    }

    h1{
        font-family:Parisienne, serif;
        margin:10px 0 6px;
        font-size:36px;
        color:var(--accent);
        letter-spacing:1px;
    }
    p.lead{
        margin:0 0 20px;
        font-size:14px;
        color:#6b3a4a;
    }

    /* mailbox */
    .mailbox{
        margin:10px auto 0;
        width:220px;
        height:140px;
        position:relative;
    }
    .box-body{
        width:100%;
        height:76%;
        background:linear-gradient(180deg,#fff6fb,var(--mail));
        border-radius:16px;
        border:3px solid rgba(255,106,150,0.12);
        box-shadow:0 6px 18px rgba(180,70,110,0.12);
        position:absolute;
        bottom:0;
        left:0;
        display:flex;
        align-items:center;
        justify-content:center;
    }
    .flag{
        position:absolute;
        right:-8%;
        top:22%;
        width:36px;
        height:26px;
        background:linear-gradient(180deg,var(--accent),#ff7aa0);
        border-radius:6px 6px 2px 2px;
        transform-origin:left center;
        transform:rotate(-8deg);
        box-shadow:0 3px 8px rgba(200,60,120,0.18);
    }

    .slot{
        width:84%;
        height:56%;
        background:linear-gradient(180deg,#fff,#fff0f6);
        border-radius:8px;
        box-shadow: inset 0 2px 6px rgba(255,110,150,0.06);
        position:relative;
        overflow:visible;
    }

    /* envelope (click target) */
    .envelope{
        position:absolute;
        top:-48px;
        left:50%;
        transform:translateX(-50%);
        width:180px;
        height:90px;
        cursor:pointer;
        transition:transform .35s cubic-bezier(.2,.9,.3,1);
        z-index:6;
        outline:none;
    }
    .envelope:focus{box-shadow:0 0 0 6px rgba(255,150,190,0.12); border-radius:12px}
    .envelope .body{
        position:absolute;
        width:100%;
        height:66%;
        bottom:0;
        background:linear-gradient(180deg,#fff,#fff7fb);
        border-radius:8px;
        border:2px solid rgba(255,110,150,0.12);
        display:flex;
        align-items:center;
        justify-content:center;
        box-shadow:0 6px 16px rgba(140,40,80,0.12);
    }
    .envelope .flap{
        position:absolute;
        width:100%;
        height:66%;
        top:0;
        left:0;
        background:linear-gradient(180deg,#ffdfea, #fff0fb);
        border-radius:8px;
        transform-origin:top center;
        transform:rotateX(0deg);
        transition:transform .45s cubic-bezier(.2,.9,.3,1);
        display:flex;
        align-items:center;
        justify-content:center;
        font-weight:600;
        color:rgba(80,20,40,0.9);
    }

    /* letter hidden inside */
    .letter{
        position:absolute;
        width:86%;
        height:84%;
        left:7%;
        top:-8%;
        background:linear-gradient(180deg,#fff,#fffefc);
        border-radius:6px;
        padding:16px;
        transform:translateY(-8px) scale(.98);
        box-shadow:0 10px 24px rgba(120,30,70,0.12);
        opacity:0;
        transition:all .45s cubic-bezier(.2,.9,.3,1);
        display:flex;
        align-items:center;
        justify-content:center;
        text-align:center;
        pointer-events:none;
    }
    .letter .content{
        font-size:16px;
        color:#5a2734;
        line-height:1.3;
        font-weight:600;
    }

    /* open state */
    .open .flap{ transform:rotateX(-160deg); }
    .open .envelope{ transform:translateX(-50%) translateY(-18px) }
    .open .letter{ opacity:1; transform:translateY(-36px) scale(1); pointer-events:auto }

    /* subtle pulse CTA */
    .hint{
        margin-top:18px;
        font-size:12px;
        color:#7a3a4a;
        opacity:0.9;
    }
    .tap{
        display:inline-block;
        padding:8px 14px;
        margin-top:10px;
        border-radius:20px;
        background:linear-gradient(90deg,#fff0fb,#fff8fc);
        border:1px solid rgba(255,120,165,0.08);
        box-shadow:0 6px 18px rgba(255,120,165,0.06);
        color:var(--accent);
        font-weight:600;
        cursor:default;
        animation:pop 2.8s infinite;
    }
    @keyframes pop{
        0%,100%{transform:translateY(0)}
        50%{transform:translateY(-6px)}
    }

    /* small responsive tweaks */
    @media (max-width:420px){
        .envelope{ width:150px; height:78px }
        .stage{ padding:18px }
    }
</style>
</head>
<body>
    <div class="sky" aria-hidden="true">
        <!-- Decorative SVG flowers -->
        <svg class="flower s1" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <linearGradient id="g1" x1="0" x2="1">
                    <stop offset="0" stop-color="#ffd9e6"/><stop offset="1" stop-color="#ff6b9f"/>
                </linearGradient>
            </defs>
            <g transform="translate(60,60)">
                <circle r="10" fill="#fff7fb" />
                <g fill="url(#g1)">
                    <ellipse rx="24" ry="10" transform="rotate(0) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(45) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(90) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(135) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(180) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(225) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(270) translate(36,0)"/>
                    <ellipse rx="24" ry="10" transform="rotate(315) translate(36,0)"/>
                </g>
            </g>
        </svg>

        <svg class="flower s2" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
            <circle cx="60" cy="60" r="12" fill="#fff9f9"/>
            <g fill="#ffd6e3" transform="translate(60,60)">
                <path d="M36 0 C30 28 30 28 0 28 C30 28 30 28 36 0 Z" transform="rotate(0)"/>
                <path d="M36 0 C30 28 30 28 0 28 C30 28 30 28 36 0 Z" transform="rotate(45)"/>
                <path d="M36 0 C30 28 30 28 0 28 C30 28 30 28 36 0 Z" transform="rotate(90)"/>
                <path d="M36 0 C30 28 30 28 0 28 C30 28 30 28 36 0 Z" transform="rotate(135)"/>
            </g>
        </svg>

        <svg class="flower s3" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg">
            <g transform="translate(60,60)">
                <circle r="8" fill="#fff"/>
                <g fill="#ffd6e3">
                    <ellipse rx="18" ry="8" transform="rotate(0) translate(30,0)"/>
                    <ellipse rx="18" ry="8" transform="rotate(60) translate(30,0)"/>
                    <ellipse rx="18" ry="8" transform="rotate(120) translate(30,0)"/>
                </g>
            </g>
        </svg>
    </div>

        <!-- Decorative teddy bears -->
        <svg class="teddy t1" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <!-- Simple teddy made from circles -->
            <g transform="translate(60,60)">
                <circle r="28" fill="#f3c28b"/>
                <circle cx="-34" cy="-24" r="12" fill="#f3c28b"/>
                <circle cx="34" cy="-24" r="12" fill="#f3c28b"/>
                <circle cx="-10" cy="-6" r="4" fill="#5a3a2f"/>
                <circle cx="10" cy="-6" r="4" fill="#5a3a2f"/>
                <path d="M -6 6 q 6 8 12 0" stroke="#5a3a2f" stroke-width="2" fill="none" stroke-linecap="round"/>
            </g>
        </svg>

        <svg class="teddy t2" viewBox="0 0 120 120" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <g transform="translate(60,60)">
                <circle r="22" fill="#e8b77a"/>
                <circle cx="-28" cy="-18" r="10" fill="#e8b77a"/>
                <circle cx="28" cy="-18" r="10" fill="#e8b77a"/>
                <circle cx="-6" cy="-4" r="3" fill="#4a2f26"/>
                <circle cx="6" cy="-4" r="3" fill="#4a2f26"/>
                <path d="M -5 6 q 5 6 10 0" stroke="#4a2f26" stroke-width="1.8" fill="none" stroke-linecap="round"/>
            </g>
        </svg>

    <main class="stage" role="main" aria-label="Romantic mailbox">
        <h1>A Letter For My Love</h1>
        <p class="lead">A little surprise —<br>tap the envelope to reveal the note.</p>><br><br>

        <div class="mailbox" aria-hidden="false">
            <div class="box-body">
                <div class="slot"></div>
            </div>

            <!-- Envelope wrapper (acts like a button) -->
            <div class="envelope" id="envelope" role="button" tabindex="0" aria-pressed="false" aria-label="Open the envelope">
                <div class="flap" id="flap">
                    <!-- small heart as hint -->
                    <svg width="40" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                        <path d="M12 21s-7.5-4.7-9.3-7.2C-0.2 1.7 6 0 9.6 3.6L12 6l2.4-2.4C18 0 23.2 1.7 21.3 13.8 19.5 16.3 12 21 12 21z" fill="#ff6b9f" opacity=".95"/>
                    </svg>
                </div>
                <div class="body"></div>

                <div class="letter" id="letter" aria-hidden="true">
                    <div class="content" id="note">
                        To my dearest,<br><br>
                        You are the blossom in my every morning. Sorry for all the troubles i made baby. I got you. Don't worry.EVERYTHING IS FINE,IF NOT IT'S JUST A BAD DAY.WE CAN MAKE THIS RIGHT XOXO.<br><br>
                        — Abhi
                    </div>
                </div>
            </div>

            <div class="flag" aria-hidden="true"></div>
        </div>

        <div class="hint" aria-hidden="true">
            <span class="tap" onclick="alert('Tap the envelope to open the message in a new popup window!')">Tap the envelope</span>
        </div>
    </main>

<script>
    // Interactivity: toggle open/close on click, touch, keyboard and open a popup window with the note
    (function(){
        const envelope = document.getElementById('envelope');
        const stage = document.querySelector('.stage');
        const letter = document.getElementById('letter');
        const note = document.getElementById('note');

        let popupWin = null;

        // Try to open a centered popup window and write the note content into it.
        function openPopup(){
            const content = note.innerHTML || '';
            const w = 420;
            const h = 360;
            const left = Math.max(0, Math.round((screen.width - w) / 2));
            const top = Math.max(0, Math.round((screen.height - h) / 2));
            const features = `width=${w},height=${h},left=${left},top=${top},resizable=yes,scrollbars=yes`;
            try{
                // Reuse existing popup if possible
                if(popupWin && !popupWin.closed){
                    popupWin.focus();
                    return true;
                }

                popupWin = window.open('', 'loveNotePopup', features);
                if(!popupWin){
                    // Popup blocked by browser
                    console.warn('Popup blocked by browser');
                    popupWin = null;
                    return false;
                }

                const doc = popupWin.document;
                doc.open();
                doc.write(`<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Love Note</title>
                    <style>
                        :root{--accent:#ff3d7f}
                        body{font-family:Montserrat, Arial, sans-serif;margin:0;padding:20px;background:linear-gradient(180deg,#fff8fb,#fff0f6);color:#5a2734}
                        .note{font-size:16px;line-height:1.45}
                        .close{display:inline-block;margin-top:18px;padding:8px 12px;border-radius:8px;background:var(--accent);color:#fff;text-decoration:none}
                    </style>
                </head><body>
                    <div class="note">${content}</div>
                    <a href="#" id="closeBtn" class="close">Close</a>
                </body></html>`);
                doc.close();
                popupWin.focus();

                // Attach close handler inside popup
                const closeBtn = doc.getElementById('closeBtn');
                if(closeBtn){
                    closeBtn.addEventListener('click', function(e){
                        e.preventDefault();
                        if(popupWin && !popupWin.closed) popupWin.close();
                        popupWin = null;
                    });
                }

                // When popup is closed by user, clear reference
                const poll = setInterval(function(){
                    if(!popupWin || popupWin.closed){ clearInterval(poll); popupWin = null; }
                }, 500);

                return true;
            }catch(err){
                console.error('Could not open popup', err);
                popupWin = null;
                return false;
            }
        }

        function setOpen(openState){
            if(openState){
                stage.classList.add('open');
                envelope.setAttribute('aria-pressed','true');
                letter.setAttribute('aria-hidden','false');
            } else {
                stage.classList.remove('open');
                envelope.setAttribute('aria-pressed','false');
                letter.setAttribute('aria-hidden','true');
                if(popupWin && !popupWin.closed){ popupWin.close(); popupWin = null; }
            }
        }

        let open = false; // tracks inline open state only
        function toggle(e){
            e && e.preventDefault();
            if(!open){
                // Attempt to open a popup first. If popup opens, keep inline envelope closed.
                const popped = openPopup();
                if(popped){
                    // popup opened (or focused); do not reveal inline letter
                    return;
                }
                // popup blocked or failed -> fallback to inline open
                open = true;
                setOpen(true);
            } else {
                // currently inline-open -> close both inline and any popup
                open = false;
                setOpen(false);
            }
        }

        envelope.addEventListener('click', toggle);
        envelope.addEventListener('touchstart', function(e){ e.preventDefault(); toggle(); }, {passive:false});
        envelope.addEventListener('keydown', function(e){
            if(e.key === 'Enter' || e.key === ' '){
                e.preventDefault();
                toggle();
            }
        });

        // close when clicking outside
        document.addEventListener('click', function(e){
            if(!envelope.contains(e.target) && open){
                open = false;
                setOpen(false);
            }
        });

        // small accessibility: focus outline visible on keyboard only
        document.addEventListener('keydown', function(e){
            if(e.key === 'Tab') document.body.classList.add('show-focus');
        });
    })();
</script>
</body>
</html>